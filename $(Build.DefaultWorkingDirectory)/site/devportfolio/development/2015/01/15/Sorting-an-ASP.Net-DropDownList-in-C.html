<p>After working on a few applications in ASP.NET I came to realize-as I am sure others have-that this seems to be no simple method sorting a DropDownList in C#.</p>

<p>I took a little time to write a custom method that would allow developers to sort ASP.NET DropDownLists based in their list item ‘Text’ or ‘Value’.
Thinking that developers may wish to add a default selection to their DropDownList, I went ahead and accommodated this scenario as well.
In Addition I also realized that some developers may add default selection list itmes with an index of “-1” from other sources such as a Database or flat file. 
Therefore, the method will first search for a default list item selection. If a default item exists (list item with value of “-1”), that Item will be added back to the top of the list and override any default selection parameter entered into the method.
However, if a default list item is not found in the DropDownList, a default selection item based on the defaultSelectionText parameter passed to the method will be created.
In the case that no default value is found and an empty string is passed to the defaultSelectionText parameter no default selection will be used.</p>

<p>Below is the ASP.NET code snippet that can be used to sort a DropDownList in C#</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre>	 <span class="kp">protected</span> <span class="n">void</span> <span class="n">sortDropDownList</span><span class="p">(</span><span class="no">DropDownList</span> <span class="n">ddl</span><span class="p">,</span> <span class="n">string</span> <span class="n">orderby</span><span class="p">,</span> <span class="n">string</span> <span class="n">defaultSelectionText</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="no">ListItem</span> <span class="n">defautListItem</span> <span class="o">=</span> <span class="n">new</span> <span class="no">ListItem</span><span class="p">();</span>

            <span class="no">List</span><span class="o">&lt;</span><span class="no">ListItem</span><span class="o">&gt;</span> <span class="n">listCopy</span> <span class="o">=</span> <span class="n">new</span> <span class="no">List</span><span class="o">&lt;</span><span class="no">ListItem</span><span class="o">&gt;</span><span class="p">();</span>
            <span class="n">foreach</span><span class="p">(</span><span class="no">ListItem</span> <span class="n">item</span> <span class="k">in</span> <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="p">)</span>
                <span class="n">listCopy</span><span class="o">.</span><span class="no">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
                <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="o">.</span><span class="no">Clear</span><span class="p">();</span>

                <span class="n">foreach</span> <span class="p">(</span><span class="no">ListItem</span> <span class="n">li</span> <span class="k">in</span> <span class="n">listCopy</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">li</span><span class="o">.</span><span class="no">Value</span><span class="o">.</span><span class="no">Equals</span><span class="p">(</span><span class="s2">"-1"</span><span class="p">))</span>
                        <span class="n">defautListItem</span> <span class="o">=</span> <span class="n">li</span><span class="p">;</span>
                        <span class="n">listCopy</span><span class="o">.</span><span class="no">Remove</span><span class="p">(</span><span class="n">defautListItem</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">orderby</span><span class="o">.</span><span class="no">ToLower</span><span class="p">()</span><span class="o">.</span><span class="no">Equals</span><span class="p">(</span><span class="s2">"text"</span><span class="p">))</span>
                    <span class="n">foreach</span> <span class="p">(</span><span class="no">ListItem</span> <span class="n">item</span> <span class="k">in</span> <span class="n">listCopy</span><span class="o">.</span><span class="no">OrderBy</span><span class="p">(</span><span class="n">item</span> <span class="o">=&gt;</span> <span class="n">item</span><span class="o">.</span><span class="no">Text</span><span class="p">))</span>
                        <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="o">.</span><span class="no">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
                <span class="k">else</span> 
                    <span class="n">foreach</span> <span class="p">(</span><span class="no">ListItem</span> <span class="n">item</span> <span class="k">in</span> <span class="n">listCopy</span><span class="o">.</span><span class="no">OrderBy</span><span class="p">(</span><span class="n">item</span> <span class="o">=&gt;</span> <span class="n">item</span><span class="o">.</span><span class="no">Value</span><span class="p">))</span>
                        <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="o">.</span><span class="no">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">defaultSelectionText</span><span class="o">.</span><span class="no">Equals</span><span class="p">(</span><span class="s2">""</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">defautListItem</span><span class="o">.</span><span class="no">Text</span><span class="o">.</span><span class="no">Equals</span><span class="p">(</span><span class="s2">""</span><span class="p">)))</span>
                    <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="o">.</span><span class="no">Insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">new</span> <span class="no">ListItem</span><span class="p">(</span><span class="n">defaultSelectionText</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">));</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">defautListItem</span><span class="o">.</span><span class="no">Text</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span>
                    <span class="n">ddl</span><span class="o">.</span><span class="no">Items</span><span class="o">.</span><span class="no">Insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">defautListItem</span><span class="p">);</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>


trigger:
- gh-pages

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self
  persistCredentials: true


- script: |
   git config --global user.email "adambaker@live.com"
   git config --global user.name "Adam Baker"
  workingDirectory: $(System.DefaultWorkingDirectory)
  displayName: 'Set config user name and email'

- script: |
   git checkout -b gh-pages
  displayName: 'check out gh-pages'
  workingDirectory: $(System.DefaultWorkingDirectory)

- script: |
   git pull
  displayName: 'git pull'
  workingDirectory: $(System.DefaultWorkingDirectory)
- task: DownloadBuildArtifacts@1
  inputs:
    buildType: 'specific'
    project: '44ddd2e1-c1d5-4817-9d63-fd204e03eaa9'
    pipeline: '3'
    specificBuildWithTriggering: true
    buildVersionToDownload: 'latest'
    downloadType: 'single'
    artifactName: 'site'
    downloadPath: '$(Build.DefaultWorkingDirectory)'
    cleanDestinationFolder: true

- script: |
   git add --all
   git commit -m "deployment $(Build.BuildNumber)"
   git push --set-upstream origin gh-pages 
  displayName: 'commit to branch'
  workingDirectory: $(System.DefaultWorkingDirectory)